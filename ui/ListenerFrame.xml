<Ui xmlns="http://www.blizzard.com/wow/ui/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.blizzard.com/wow/ui/ ..\..\FrameXML\UI.xsd">
  <Script file="ListenerFrame.lua"/>
  <Script file="ListenerFrameMenu.lua"/>
  
  <!-- ListenerFrame definition. -->
  <Frame name="ListenerFrame" parent="UIParent" enableMouse="true" movable="true" 
                              resizable="true"  hidden="false"     frameStrata="BACKGROUND" 
                              intrinsic="true">
                              
    <!-- Default size is overridden by lua. -->
    <Size x="200" y="300"/>
		<ResizeBounds>
			<minResize>
				<AbsDimension x="200" y="100"/>
			</minResize>
		</ResizeBounds>
    <Anchors>
      <Anchor point="CENTER"><Offset x="0" y="0"/></Anchor>
    </Anchors>
    
    <Layers>
    
      <!-- Backdrop -->
      <Layer level="BACKGROUND">
        <Texture parentKey="bg" setallpoints="true">
          <Color b="0.0" r="0.0" g="0.0" a="0.25"/>
        </Texture>
      </Layer>
      
      
      <Layer level="ARTWORK">
        <!-- The line that separates new messages. -->
        <Texture parentKey="readmark" hidden="true">
          <Size y="1"/>
          <Anchors>
            <Anchor point="LEFT" x="1" />
            <Anchor point="RIGHT" x="-1" />
          </Anchors>
          <Color b="0.0" r="0.0" g="0.0" a="0.25"/>
        </Texture>
      </Layer>
    </Layers>
    
    <Scripts>
      <OnLoad>      ListenerAddon.Frame.OnLoad(self) </OnLoad> 
      <OnEnter>     ListenerAddon.Frame.OnEnter(self) </OnEnter>
      <OnLeave>     ListenerAddon.Frame.OnLeave(self) </OnLeave>
      <OnMouseDown> ListenerAddon.Frame.OnMouseDown( self, button ) </OnMouseDown>
      <OnMouseUp>   ListenerAddon.Frame.OnMouseUp( self, button ) </OnMouseUp>
    </Scripts>
    
    <Frames>
      <!-- Titlebar -->
      <Frame name="$parentBar2" parentKey="bar2" enableMouse="false">
        <Anchors>
          <Anchor point="TOPLEFT" x="0" y="0" />
          <Anchor point="BOTTOMRIGHT" relativePoint="TOPRIGHT"><Offset x="0" y="-15"/></Anchor>
        </Anchors>
        
        <Layers>
          <Layer level="BACKGROUND">
            <Texture parentKey="bg" setallpoints="true">
              <Color b="0.0" r="0.0" g="0.0" a="0.25"/>
            </Texture>
          </Layer>
        </Layers>
        
        <Frames>
          <!-- Title text -->
          <ListenerTextButton parentKey="title">
            <Size x="100"/>
            <Anchors>
              <Anchor point="TOP"/>
              <Anchor point="BOTTOM"/>
              <Anchor point="LEFT" x="0"/>
            </Anchors>
            <Scripts>
              <OnLoad>
                self.auto_size = true
                self.auto_size_padding = 16
                self:SetText( "â€”" )
                self:RegisterForClicks( "LeftButtonUp", "RightButtonUp" )
              </OnLoad>
              <OnClick>
                ListenerAddon:TogglePlayerClicked( button )
              </OnClick>
            </Scripts>
          </ListenerTextButton>
          
          <!-- X button -->
          <ListenerBarButton parentKey="close_button">
            <Anchors>
              <Anchor point="TOPRIGHT" x="0" y="0"/>
            </Anchors>
            <Scripts>
              <OnLoad>
                self:SetTexture( 0 )
              </OnLoad>
              <OnClick>
                ListenerAddon:HideFrame()
              </OnClick>
            </Scripts>
          </ListenerBarButton>
          
          <!-- EYE button -->
          <ListenerBarButton parentKey="hidden_button">
            <Anchors>
              <Anchor point="TOPRIGHT" x="-15" y="0"/>
            </Anchors>
            <Scripts>
              <OnLoad>
                self:SetTexture( 2 )
              </OnLoad>
              <OnClick>
                ListenerAddon:SetShowHidden( not ListenerAddon.db.char.showhidden )
              </OnClick>
            </Scripts>
          </ListenerBarButton>
          
          <!-- Dummy button to show if player is filtered. -->
          <ListenerBarButton parentKey="toggle_button" hidden="true">
            <Anchors>
              <Anchor point="TOPLEFT" x="-2" y="0"/>
            </Anchors>
            <Scripts>
              <OnLoad>
                self:EnableMouse( false )
                self:SetTexture( 1 )
              </OnLoad>
            </Scripts>
          </ListenerBarButton>
          
        </Frames>
      </Frame>
      
      <!-- The mark at the bottom of the chatbox to 
           show if the user is not scrolled all the way down. -->
      <Frame name="$parentScrollmark" parentKey="scrollmark" hidden="true">
        <Anchors>
          <Anchor point="TOPLEFT" relativePoint="BOTTOMLEFT"><Offset x="1" y="3"/></Anchor>
          <Anchor point="BOTTOMRIGHT" relativePoint="BOTTOMRIGHT"><Offset x="-1" y="1"/></Anchor>
        </Anchors>
        <Layers>
          <Layer setAllPoints="true">
            <Texture parentKey="tex">
              
              <Color r="1.0" g="1.0" b="1.0" a="0.25" />
            </Texture>
          </Layer>
        </Layers>
      </Frame>
      
      <!-- The resize thumb that appears when shift is held. -->
      <Button name="$parentResizeButton" parentKey="resize_thumb" hidden="true">
        
				<Size x="12" y="12"/>
        <Anchors>
          <Anchor point="BOTTOMRIGHT" x="-1" y="1"/>
        </Anchors>
				<Scripts>
					<OnMouseDown>
            ListenerAddon.FrameResizeButton_OnMouseDown( self, button )
            
					</OnMouseDown>
					<OnMouseUp>
            ListenerAddon.FrameResizeButton_OnMouseUp( self, button )
            
					</OnMouseUp>
          <OnLeave>
            ListenerAddon.FrameResizeButton_OnLeave( self )
          </OnLeave>
				</Scripts>
				<NormalTexture file="Interface\ChatFrame\UI-ChatIM-SizeGrabber-Up"/>
				<HighlightTexture file="Interface\ChatFrame\UI-ChatIM-SizeGrabber-Highlight"/>
				<PushedTexture file="Interface\ChatFrame\UI-ChatIM-SizeGrabber-Down"/>
      </Button>
      
      <!-- The main chatbox.
      <ScrollingMessageFrame name="$parentChat" parentKey="chatbox" maxlines="500" displayduration="300" nonspacewrap="true">
        <Anchors>
          <Anchor point="TOPLEFT" x="4" y="-6"/>
          <Anchor point="BOTTOMRIGHT" x="-2" y="3"/>
        </Anchors>
				<Scripts>
          <OnLoad>
            self:SetClipsChildren( true )
            self:SetJustifyH( "LEFT" )
            self:EnableMouseWheel( true )
            self:SetHyperlinksEnabled( true )
            self:SetIndentedWordWrap( true )
            self:SetPoint( "TOPLEFT", self:GetParent().bar2, "BOTTOMLEFT", 4, 0 )
            
            hooksecurefunc( self, "RefreshDisplay", function()
            
              ListenerAddon.Frame.OnChatboxRefresh( self:GetParent() )
              
            end
            self:SetFading( false )
            
          </OnLoad>
          
          <OnMouseWheel>
            ListenerAddon.Frame.OnChatboxScroll( self:GetParent(), delta )
          </OnMouseWheel>
          <OnHyperlinkClick>
            ListenerAddon.Frame.OnChatboxHyperlinkClick( self:GetParent(), link, text, button )
          </OnHyperlinkClick>
        </Scripts>
      </ScrollingMessageFrame>
       -->
      
      
    </Frames>
  </Frame>
</Ui>








